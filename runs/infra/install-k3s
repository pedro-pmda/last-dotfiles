#!/bin/bash

set -e

echo "ğŸ”„ Actualizando Homebrew..."
brew update

echo "ğŸº Instalando k3d (wrapper de K3s para Docker)..."
brew install k3d

echo "ğŸ³ Verificando si Docker estÃ¡ corriendo..."
if ! pgrep -f Docker.app > /dev/null; then
  echo "âš ï¸  Docker no parece estar activo. Abre Docker Desktop y vuelve a intentarlo."
  exit 1
fi

echo "ğŸš€ Creando cluster K3s local usando k3d..."
k3d cluster create peter-cluster --agents 2 --port 8080:80@loadbalancer

echo "âœ… K3s cluster creado. Puedes verificarlo con:"
echo "   kubectl get nodes"

